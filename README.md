# ğŸ“¦ Supply Chain Demand Forecasting & Inventory Optimization

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.10+-3776AB?style=for-the-badge&logo=python&logoColor=white"/>
  <img src="https://img.shields.io/badge/Excel-217346?style=for-the-badge&logo=microsoft-excel&logoColor=white"/>
  <img src="https://img.shields.io/badge/Power%20BI-F2C811?style=for-the-badge&logo=powerbi&logoColor=black"/>
  <img src="https://img.shields.io/badge/Status-Complete-1E8449?style=for-the-badge"/>
</p>

> **Personal Project Â· February 2025 Â· Mousumi Paul**

An end-to-end supply chain analytics solution covering **demand forecasting** and **inventory optimization** across 5 product categories using 12 months of historical sales data â€” achieving **88% forecast accuracy** and an estimated **22% reduction in excess inventory holding costs**.

---

## ğŸ“Œ Table of Contents

- [Project Overview](#-project-overview)
- [Key Results](#-key-results)
- [Project Structure](#-project-structure)
- [Excel Workbook](#-excel-workbook)
- [Forecasting Models](#-forecasting-models)
- [Inventory Optimization](#-inventory-optimization)
- [Power BI Dashboard](#-power-bi-dashboard)
- [Setup & Usage](#-setup--usage)
- [Tech Stack](#-tech-stack)

---

## ğŸ” Project Overview

This project simulates a real-world supply chain analytics workflow for a retail business managing 5 product categories:

| Code | Category |
|------|----------|
| P01 | Electronics |
| P02 | Apparel |
| P03 | Home & Kitchen |
| P04 | Sports & Outdoors |
| P05 | Beauty & Health |

**Two core problems solved:**

1. **Demand Forecasting** â€” Predict monthly unit demand using Moving Averages (3M, 6M) and Exponential Smoothing, then evaluate each model's accuracy using MAPE, MAE, and RMSE.

2. **Inventory Optimization** â€” Calculate optimal order quantities (EOQ), safety stock levels, and reorder points to minimize total inventory cost while maintaining a 95% service level.

---

## ğŸ† Key Results

| Metric | Result |
|--------|--------|
| ğŸ“ˆ Overall Forecast Accuracy | **~88%** (best model per category) |
| ğŸ’° Excess Holding Cost Reduction | **~22%** vs fixed-order-quantity baseline |
| ğŸ“¦ Products with Optimized EOQ | **5 / 5** |
| âš ï¸ Automated Low-Stock Alerts | **Live (Power BI + Excel)** |
| ğŸ”¢ Excel Live Formulas | **365 (0 errors)** |

### Forecast Accuracy by Category

| Category | Best Model | Accuracy |
|----------|-----------|----------|
| Electronics | Exponential Smoothing | ~90% |
| Apparel | Exponential Smoothing | ~88% |
| Home & Kitchen | 3-Month MA | ~89% |
| Sports & Outdoors | 6-Month MA | ~88% |
| Beauty & Health | Exponential Smoothing | ~91% |

### Inventory Parameters

| Category | EOQ (units) | Safety Stock | Reorder Point |
|----------|-------------|--------------|---------------|
| Electronics | 183 | 90 | 428 |
| Apparel | 242 | 74 | 355 |
| Home & Kitchen | 200 | 56 | 291 |
| Sports & Outdoors | 204 | 103 | 450 |
| Beauty & Health | 330 | 49 | 326 |

---

## ğŸ“ Project Structure

```
supply-chain-forecasting/
â”‚
â”œâ”€â”€ ğŸ“Š excel/
â”‚   â””â”€â”€ SupplyChain_Forecast_Inventory.xlsx   â† 6-sheet model Â· 365 live formulas
â”‚
â”œâ”€â”€ ğŸ“ˆ powerbi/
â”‚   â”œâ”€â”€ dax_measures.md                        â† 20+ DAX measures documented
â”‚   â””â”€â”€ SupplyChain_Dashboard_PLACEHOLDER.txt  â† Power BI rebuild guide
â”‚
â”œâ”€â”€ ğŸ“‚ data/
â”‚   â”œâ”€â”€ raw/
â”‚   â”‚   â”œâ”€â”€ sales_data_2024.csv                â† 60-row monthly sales dataset
â”‚   â”‚   â””â”€â”€ inventory_params.csv               â† EOQ input parameters per product
â”‚   â””â”€â”€ processed/
â”‚       â”œâ”€â”€ forecast_output.csv                â† Generated by notebook 02
â”‚       â””â”€â”€ inventory_optimization_output.csv  â† Generated by notebook 03
â”‚
â”œâ”€â”€ ğŸ““ notebooks/
â”‚   â”œâ”€â”€ 01_data_prep_eda.ipynb                 â† EDA, seasonality, quality checks
â”‚   â”œâ”€â”€ 02_demand_forecasting.ipynb            â† MA + ES models, accuracy reports
â”‚   â”œâ”€â”€ 03_inventory_optimization.ipynb        â† EOQ/ROP/SS + cost savings analysis
â”‚   â””â”€â”€ 04_full_pipeline_report.ipynb          â† End-to-end pipeline + KPI summary
â”‚
â”œâ”€â”€ ğŸ src/
â”‚   â”œâ”€â”€ demand_forecasting.py                  â† Forecasting engine (MA + ES + metrics)
â”‚   â”œâ”€â”€ inventory_optimization.py              â† EOQ/ROP/Safety Stock + cost curves
â”‚   â””â”€â”€ utils.py                               â† Helpers: formatting, export, reporting
â”‚
â”œâ”€â”€ ğŸ“¤ outputs/
â”‚   â”œâ”€â”€ charts/                                â† Auto-saved PNG visualizations
â”‚   â””â”€â”€ reports/                               â† Combined CSV reports
â”‚
â”œâ”€â”€ ğŸ“„ docs/
â”‚   â””â”€â”€ methodology.md                         â† Full formula derivations & assumptions
â”‚
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

---

## ğŸ“Š Excel Workbook

The workbook `SupplyChain_Forecast_Inventory.xlsx` contains **6 sheets** with **365 live formulas** and zero errors.

| Sheet | Description |
|-------|-------------|
| `Sales_Data` | Raw 12-month unit sales Â· MoM growth % Â· trend line chart |
| `Demand_Forecast` | 3MA, 6MA, Exp Smoothing per product + MAPE accuracy |
| `Inventory_Optimization` | EOQ, Safety Stock, ROP, annual holding & ordering costs |
| `Stock_Health` | Live alert dashboard: ğŸ”´ğŸŸ ğŸŸ¡ğŸŸ¢ status + recommended actions |
| `Accuracy_Summary` | Best model by category Â· 88% target check |
| `Guide` | Color legend, formula reference, model navigation |

### Color Coding Convention

| Color | Meaning |
|-------|---------|
| ğŸ”µ **Blue text** | Hardcoded inputs â€” safe to edit |
| âš« **Black text** | Formula outputs â€” do not modify |
| ğŸŸ¢ **Green text** | Cross-sheet links |
| ğŸŸ¡ **Yellow background** | Key assumption cells |
| **Teal highlight** | EOQ output values |
| **Green highlight** | Safety stock values |
| **Blue highlight** | Reorder point values |
| **Amber highlight** | Forecast months + excess cost flags |

---

## ğŸ“ˆ Forecasting Models

Three models are implemented and compared for each product category.

### 1. Moving Average (3-Month & 6-Month)

```
MA_t(n) = (A_t + A_{t-1} + ... + A_{t-n+1}) / n
```

- **3-Month MA** â€” Reacts quickly to recent demand shifts; good for volatile categories
- **6-Month MA** â€” Smooths seasonal noise; better for stable demand patterns

### 2. Exponential Smoothing (Î± = 0.3)

```
F_t = Î± Ã— A_{t-1} + (1 - Î±) Ã— F_{t-1}
```

Where Î± = smoothing parameter (0.3 default, tuned via sensitivity analysis). Higher Î± = more weight to recent data.

### 3. Accuracy Metrics

| Metric | Formula | Used For |
|--------|---------|----------|
| **MAPE** | Mean(\|Aâˆ’F\|/A) Ã— 100 | Model selection (primary) |
| **MAE** | Mean(\|Aâˆ’F\|) | Absolute unit error |
| **RMSE** | âˆšMean((Aâˆ’F)Â²) | Penalizing large errors |

---

## ğŸ“¦ Inventory Optimization

### Economic Order Quantity (EOQ)

```
EOQ = âˆš(2 Ã— D Ã— S / H)
```

| Variable | Description | Value |
|----------|-------------|-------|
| D | Annual demand (units) | Per product |
| S | Ordering cost per order | â‚¹2,500 |
| H | Holding cost per unit/year | Unit Cost Ã— Holding % |

### Safety Stock

```
Safety Stock = Z Ã— Ïƒ_demand Ã— âˆš(Lead Time / 30)
```

- Z = 1.65 (95% service level)
- Lead Time = 14 days

### Reorder Point

```
ROP = (Daily Demand Ã— Lead Time in Days) + Safety Stock
```

### Annual Cost Model

```
Annual Holding Cost  = (EOQ/2 + Safety Stock) Ã— H
Annual Ordering Cost = (D / EOQ) Ã— S
Total Inventory Cost = Holding Cost + Ordering Cost
```

---

## âš¡ Power BI Dashboard

The dashboard has **5 pages** with **20+ DAX measures**. Full measure definitions are in [`powerbi/dax_measures.md`](powerbi/dax_measures.md).

**Dashboard Pages:**
1. **Executive Summary** â€” KPI cards, overall demand trend, alert banner
2. **Demand Forecast** â€” Actual vs forecast lines, MAPE accuracy matrix, model slicer
3. **Inventory Health** â€” Stock vs ROP vs Safety Stock, status table with conditional formatting
4. **Cost Analysis** â€” Holding vs ordering cost breakdown, 22% savings waterfall
5. **Low-Stock Alerts** â€” Dynamic color alerts, reorder recommendations, days-of-supply gauge

**Key DAX Measures include:**
- `[Rolling 3M Avg Demand]` â€” DATESINPERIOD lookback
- `[Products Below ROP]` â€” Dynamic COUNTX filter
- `[Stock Alert Color]` â€” Conditional hex color for formatting
- `[Low Stock Alert Message]` â€” Plain-language alert string
- `[Forecast Accuracy %]` â€” Linked to DimForecast table

---

## âš™ï¸ Setup & Usage

### Prerequisites
```bash
pip install -r requirements.txt
```

### Run Notebooks (Recommended)
```bash
# Step 1 â€“ EDA & data validation
jupyter notebook notebooks/01_data_prep_eda.ipynb

# Step 2 â€“ Demand forecasting + accuracy report
jupyter notebook notebooks/02_demand_forecasting.ipynb

# Step 3 â€“ Inventory optimization + cost savings
jupyter notebook notebooks/03_inventory_optimization.ipynb

# Step 4 â€“ Full pipeline + executive KPI summary
jupyter notebook notebooks/04_full_pipeline_report.ipynb
```

### Run Python Scripts Directly
```bash
cd src
python demand_forecasting.py       # â†’ data/processed/forecast_output.csv + charts
python inventory_optimization.py   # â†’ data/processed/inventory_optimization_output.csv + charts
```

### Use the Excel Model
1. Open `excel/SupplyChain_Forecast_Inventory.xlsx`
2. Go to `Inventory_Optimization` â€” update **blue cells** (current stock, lead time, costs)
3. Go to `Stock_Health` â€” live alert status updates automatically
4. All 365 formulas recalculate instantly on data change

### Rebuild Power BI Dashboard
1. Import CSVs from `data/processed/` as data sources
2. Create `DimDate` in Power Query
3. Set up relationships (see `powerbi/dax_measures.md`)
4. Paste all DAX measures from `powerbi/dax_measures.md`
5. Configure conditional formatting with `[Stock Alert Color]`

---

## ğŸ›  Tech Stack

| Tool | Purpose |
|------|---------|
| **Python 3.10+** | Forecasting engine, optimization logic, charting |
| **pandas / numpy** | Data manipulation and numerical computation |
| **matplotlib** | Forecast charts, EOQ cost curves, stock health visuals |
| **openpyxl** | Excel workbook creation with live formulas |
| **Microsoft Excel** | Interactive model with dynamic formulas & charts |
| **Power BI** | Live dashboard with DAX measures and low-stock alerts |
| **Jupyter Notebooks** | Step-by-step analysis and reporting |

---

## ğŸ“„ Documentation

Full methodology, formula derivations, and model assumptions are documented in [`docs/methodology.md`](docs/methodology.md).

---

## ğŸ“¬ Contact

**Mousumi Paul**  
[![LinkedIn](https://img.shields.io/badge/LinkedIn-0077B5?style=flat&logo=linkedin&logoColor=white)](https://linkedin.com/in/mousumi-paul)
[![GitHub](https://img.shields.io/badge/GitHub-181717?style=flat&logo=github&logoColor=white)](https://github.com/mousumi-paul)
